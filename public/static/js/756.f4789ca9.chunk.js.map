{"version":3,"file":"static/js/756.f4789ca9.chunk.js","mappings":"uPAUe,SAASA,IACvB,OAAkDC,EAAAA,EAAAA,UAAS,IAA3D,eAAOC,EAAP,KAA0BC,EAA1B,KACA,GAA4BF,EAAAA,EAAAA,WAAS,GAArC,eAEA,GAFA,WACiBG,EAAAA,EAAAA,OAC0BC,EAAAA,EAAAA,KAAY,SAAAC,GAAK,OAAIA,EAAMC,SAA9DC,EAAR,EAAQA,YAAaC,EAArB,EAAqBA,OAAQC,EAA7B,EAA6BA,UACvBC,GAAqBN,EAAAA,EAAAA,KAAY,SAAAC,GAAK,OAAIA,EAAMM,UAAUC,oBA+BhE,SAASC,EAAIC,EAAGC,GAEf,IADA,IAAIC,EAAM,GACDC,EAAI,EAAGA,EAAIH,EAAEI,OAAQD,IAC7B,IAAK,IAAIE,EAAI,EAAGA,EAAIJ,EAAEG,OAAQC,IACxBL,EAAEG,GAAGG,IAAKC,SAASN,EAAEI,KACzBH,EAAIM,KAAKR,EAAEG,IAId,OAAOD,EAIR,SAASO,EAAQZ,GACZA,EAAUO,QACbM,QAAQC,IACPd,EAAUe,KAAI,SAAAC,GAAE,OAAIC,MAAMC,qBAA6BF,GACrDG,MAAK,SAAAC,GAAG,OAAIA,EAAIC,UAChBF,MAAK,SAAAC,GACA9B,EAAkByB,KAAI,SAAAO,GAAC,OAAIA,EAAEb,OAAKC,SAASU,EAAIX,MACnDlB,GAAqB,SAAAD,GAAiB,wBAAQA,GAAR,CAA2B8B,cAQvE,OAvDAG,EAAAA,EAAAA,YAAU,WACTC,SAASC,KAAKC,mBACZ,KAEHH,EAAAA,EAAAA,YAAU,WACL1B,GACHe,EAAQhB,EAAYI,aAEnB,CAACH,KAEJ0B,EAAAA,EAAAA,YAAU,WACL1B,GACHN,EAAqBW,EAAIZ,EAAmBM,EAAYI,cAEvD,CAACJ,KAGJ2B,EAAAA,EAAAA,YAAU,WACJ1B,IACAP,EAAkBiB,OACrBhB,EAAqBW,EAAIZ,EAAmBS,IAE5Ca,EAAQb,MAGR,CAACA,KA+BH,qBAAS4B,UAAU,iBAAnB,WACC,eAAIA,UAAU,wBAAd,qEACA,gBAAKA,UAAU,uBAAf,SAEE7B,GASER,EAAkBiB,QARpB,8BAEEjB,EAAkByB,KAAI,SAACa,EAASC,GAAV,OACrB,SAACC,EAAA,EAAD,CAAmCF,QAASA,GAAtBA,EAAQnB,WAchC,SAACsB,EAAA,EAAD,OAGH,iBAAKJ,UAAU,0BAAf,WACC,eAAIA,UAAU,gCAAd,4EACA,SAACK,EAAA,EAAD","sources":["Components/Pages/FavoritesPage/FavoritesPage.jsx"],"sourcesContent":["import axios from 'axios';\r\nimport React, { useState } from 'react';\r\nimport './favoritespage.scss';\r\nimport { useEffect } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport ProductCardItem from '../../Layout/ProductCardItem/ProductCardItem';\r\nimport Watched from '../../Layout/Watched/Watched';\r\nimport SpinnerLoad from '../../Layout/SpinnerLoad/SpinnerLoad';\r\n\r\nexport default function FavoritesPage() {\r\n\tconst [productsFavorites, setProductsFavorites] = useState([]);\r\n\tconst [isLoad, setIsLoad] = useState(false);\r\n\tconst navigate = useNavigate();\r\n\tconst { currentUser, isAuth, isLoading } = useSelector(state => state.user);\r\n\tconst favoritesFromRedux = useSelector(state => state.favorites.currentFavorites);\r\n\tconst API_URL = process.env.REACT_APP_BASE_URL;\r\n\t// const goError = () => navigate('/404', { replace: true });\r\n\t// console.log(currentUser);\r\n\tuseEffect(() => {\r\n\t\tdocument.body.scrollIntoView();\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isAuth) {\r\n\t\t\tpromAll(currentUser.favorites)\r\n\t\t}\r\n\t}, [isAuth])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isAuth) {\r\n\t\t\tsetProductsFavorites(def(productsFavorites, currentUser.favorites))\r\n\t\t}\r\n\t}, [currentUser]);\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!isAuth) {\r\n\t\t\tif (productsFavorites.length) {\r\n\t\t\t\tsetProductsFavorites(def(productsFavorites, favoritesFromRedux))\r\n\t\t\t} else {\r\n\t\t\t\tpromAll(favoritesFromRedux)\r\n\t\t\t}\r\n\t\t}\r\n\t}, [favoritesFromRedux])\r\n\r\n\tfunction def(a, b) {\r\n\t\tlet arr = [];\r\n\t\tfor (let i = 0; i < a.length; i++) {\r\n\t\t\tfor (let j = 0; j < b.length; j++) {\r\n\t\t\t\tif ((a[i]._id).includes(b[j])) {\r\n\t\t\t\t\tarr.push(a[i])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn arr;\r\n\t}\r\n\r\n\r\n\tfunction promAll(favorites) {\r\n\t\tif (favorites.length) {\r\n\t\t\tPromise.all(\r\n\t\t\t\tfavorites.map(id => fetch(API_URL + '/product/byid/' + id)\r\n\t\t\t\t\t.then(val => val.json())\r\n\t\t\t\t\t.then(val => {\r\n\t\t\t\t\t\tif (!productsFavorites.map(v => v._id).includes(val._id)) {\r\n\t\t\t\t\t\t\tsetProductsFavorites(productsFavorites => [...productsFavorites, val])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t))\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<article className='favorites-page'>\r\n\t\t\t<h1 className='favorites-page__title'>Избранное</h1>\r\n\t\t\t<div className='favorites-page__grid'>\r\n\r\n\t\t\t\t{isLoading ?\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tproductsFavorites.map((product, index) =>\r\n\t\t\t\t\t\t\t\t<ProductCardItem key={product._id} product={product} />\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t</>\r\n\t\t\t\t\t: productsFavorites.length ?\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tproductsFavorites.map((product, index) =>\r\n\t\t\t\t\t\t\t\t\t<ProductCardItem key={product._id} product={product} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t</> :\r\n\t\t\t\t\t\t<SpinnerLoad />\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t\t<div className='favorites-page__watched'>\r\n\t\t\t\t<h2 className='favorites-page__watched-title'>Вы смотрели</h2>\r\n\t\t\t\t<Watched />\r\n\t\t\t</div>\r\n\t\t</article>\r\n\t);\r\n}\r\n"],"names":["FavoritesPage","useState","productsFavorites","setProductsFavorites","useNavigate","useSelector","state","user","currentUser","isAuth","isLoading","favoritesFromRedux","favorites","currentFavorites","def","a","b","arr","i","length","j","_id","includes","push","promAll","Promise","all","map","id","fetch","API_URL","then","val","json","v","useEffect","document","body","scrollIntoView","className","product","index","ProductCardItem","SpinnerLoad","Watched"],"sourceRoot":""}